"use strict";(self.webpackChunkopen_collab=self.webpackChunkopen_collab||[]).push([[883],{4883:(pt,T,i)=>{i.r(T),i.d(T,{ProjectModule:()=>rt});var p=i(9808),m=i(9749),h=i(3900),t=i(5e3),j=i(9176),u=i(8951),b=i(3372),y=i(1680);let I=(()=>{class n{constructor(e,o){this.auth=e,this.userService=o}ngOnInit(){}getVotes(){return this.auth.userInfo().pipe((0,h.w)(e=>this.userService.getVotes(null==e?void 0:e.uid)))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.e),t.Y36(b.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project-header"]],inputs:{project:"project"},decls:1,vars:3,consts:[[3,"project","currentUserVotes","fromProject"]],template:function(e,o){1&e&&t._UZ(0,"app-post",0),2&e&&t.Q6J("project",o.project)("currentUserVotes",o.getVotes())("fromProject",!0)},directives:[y.A],styles:[""]}),n})();var d=i(3737),l=i(2308),r=i(2382),f=i(3579),Z=i(3867),D=i(7531),C=i(7423);const x=function(n){return{task:n,delete:!0}};function L(n,s){if(1&n&&(t.TgZ(0,"button",8),t._uU(1,"Delete "),t.qZA()),2&n){const e=t.oxw();t.Q6J("mat-dialog-close",t.VKq(1,x,e.data.task))}}const U=function(n){return{task:n}};let P=(()=>{class n{constructor(e,o,a,c,g,ct){this.dialogRef=e,this.data=o,this.kanbanService=a,this.formBuilder=c,this.auth=g,this.route=ct,this.backupTask=Object.assign({},this.data.task),this.newTask=new t.vpe}ngOnInit(){var e;let o=null===(e=this.route.firstChild)||void 0===e?void 0:e.snapshot.paramMap.get("id");this.taskForm=new r.cw({title:new r.NI("",r.kI.required),content:new r.NI(""),category:new r.NI(0),taskid:new r.NI(Math.floor(1e5*Math.random())),projectid:new r.NI(o)})}taskSubmit(){this.taskForm.valid?this.kanbanService.createTask(this.taskForm.value).subscribe(e=>{this.taskForm.reset()}):this.errormsg="You must input a title!",this.dialogRef.close(this.taskForm.value)}cancel(){this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.so),t.Y36(l.WI),t.Y36(f.g),t.Y36(r.qu),t.Y36(u.e),t.Y36(m.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-dialog"]],outputs:{newTask:"newTask"},decls:15,vars:7,consts:[[3,"formGroup"],[1,"field"],["matInput","","cdkFocusInitial","","formControlName","title",3,"ngModel","ngModelChange"],["matInput","","formControlName","content",3,"ngModel","ngModelChange"],["mat-dialog-actions",""],["mat-button","","aria-label","Delete",3,"mat-dialog-close",4,"ngIf"],["mat-button","","aria-label","Ok",3,"mat-dialog-close","click"],["mat-button","","aria-label","Cancel",3,"click"],["mat-button","","aria-label","Delete",3,"mat-dialog-close"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),t._uU(3,"Title"),t.qZA(),t.TgZ(4,"input",2),t.NdJ("ngModelChange",function(c){return o.data.task.title=c}),t.qZA()(),t.TgZ(5,"mat-form-field",1)(6,"mat-label"),t._uU(7,"Content"),t.qZA(),t.TgZ(8,"textarea",3),t.NdJ("ngModelChange",function(c){return o.data.task.content=c}),t.qZA()(),t.TgZ(9,"div",4),t.YNc(10,L,2,3,"button",5),t.TgZ(11,"button",6),t.NdJ("click",function(){return o.taskSubmit()}),t._uU(12,"OK"),t.qZA(),t.TgZ(13,"button",7),t.NdJ("click",function(){return o.cancel()}),t._uU(14,"Cancel"),t.qZA()()()),2&e&&(t.Q6J("formGroup",o.taskForm),t.xp6(4),t.Q6J("ngModel",o.data.task.title),t.xp6(4),t.Q6J("ngModel",o.data.task.content),t.xp6(2),t.Q6J("ngIf",o.data.enableDelete),t.xp6(1),t.Q6J("mat-dialog-close",t.VKq(5,U,o.data.task)))},directives:[r._Y,r.JL,r.sg,Z.KE,Z.hX,D.Nt,r.Fj,r.JJ,r.u,l.H8,p.O5,C.lW,l.ZT],styles:[".field[_ngcontent-%COMP%]{width:100%}"]}),n})();var A=i(4594),_=i(845),k=i(9224),M=i(4036);function N(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card")(1,"h2"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"p-dropdown",1),t.NdJ("ngModelChange",function(a){return t.CHM(e),t.oxw().assignedUser=a})("onChange",function(){t.CHM(e);const a=t.oxw();return a.updateTask(a.task)}),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA(),t.TgZ(10,"button",2),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return a.deleteTask(a.task.taskid)}),t._uU(11,"Delete"),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.task.title),t.xp6(2),t.hij(" ",e.task.content,""),t.xp6(1),t.Q6J("options",e.users)("filter",!0)("ngModel",e.assignedUser),t.xp6(2),t.hij("Assigned to: ",e.task.assignedto,""),t.xp6(2),t.hij("Selected user: ",null==e.assignedUser?null:e.assignedUser.name,"")}}let O=(()=>{class n{constructor(e,o){this.kanbanService=e,this.userService=o,this.users=[],this.tasks=[],this.task=null,this.edit=new t.vpe,this.deleteEvent=new t.vpe}ngOnInit(){this.fetchUsers()}deleteTask(e){this.kanbanService.deleteTask(e).subscribe(o=>{this.deleteEvent.emit()})}fetchTasks(){this.kanbanService.getAllTasks().subscribe(e=>{this.tasks=e})}fetchUsers(){this.userService.getUsers().subscribe(e=>{this.users=e})}updateTask(e){var o;this.kanbanService.updateTask({category:e.category,assignedto:null===(o=this.assignedUser)||void 0===o?void 0:o.id},e.taskid).subscribe(a=>{})}getUserName(e){this.userService.getUser(e).subscribe(o=>{console.log(o.name,"user"),this.assignedName=o.name})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.g),t.Y36(b.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task"]],inputs:{task:"task"},outputs:{edit:"edit",deleteEvent:"deleteEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["optionLabel","name","placeholder","change assignee",3,"options","filter","ngModel","ngModelChange","onChange"],["mat-flat-button","","color","warn",3,"click"]],template:function(e,o){1&e&&t.YNc(0,N,12,7,"mat-card",0),2&e&&t.Q6J("ngIf",o.task)},directives:[p.O5,k.a8,M.Lt,r.JJ,r.On,C.lW],styles:[""]}),n})();function Y(n,s){1&n&&(t.TgZ(0,"p",11),t._uU(1,"Empty list"),t.qZA())}function S(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",12),t.NdJ("deleteEvent",function(){return t.CHM(e),t.oxw().recieveDelete()}),t.qZA()}2&n&&t.Q6J("task",s.$implicit)}function F(n,s){1&n&&(t.TgZ(0,"p",11),t._uU(1,"Empty list"),t.qZA())}function w(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",12),t.NdJ("deleteEvent",function(){return t.CHM(e),t.oxw().recieveDelete()}),t.qZA()}2&n&&t.Q6J("task",s.$implicit)}function Q(n,s){1&n&&(t.TgZ(0,"p",11),t._uU(1,"Empty list"),t.qZA())}function E(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-task",12),t.NdJ("deleteEvent",function(){return t.CHM(e),t.oxw().recieveDelete()}),t.qZA()}2&n&&t.Q6J("task",s.$implicit)}const v=function(n,s){return[n,s]};let K=(()=>{class n{constructor(e,o,a){this.dialog=e,this.kanbanService=o,this.route=a,this.tasks=[],this.todo=[],this.inProgress=[],this.done=[],this.displayDialog=!1}ngOnInit(){this.fetchData()}fetchData(){console.log("got here"),this.kanbanService.getAllTasks().subscribe(e=>{console.log(e,"ALL TASK"),this.projID=this.route.snapshot.paramMap.get("id"),this.tasks=e,this.tasks=this.tasks.filter(o=>parseInt(o.projectid)===parseInt(this.projID)),this.todo=this.tasks.filter(o=>0===o.category),this.inProgress=this.tasks.filter(o=>1===o.category),this.done=this.tasks.filter(o=>2===o.category)})}drop(e){if(e.previousContainer===e.container||!e.container.data||!e.previousContainer.data)return;(0,d.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex);let o=0;for(let a of e.container.data)o="todo"===e.container.id?0:"inProgress"===e.container.id?1:2,a.category!==o&&this.kanbanService.updateTask({category:o,assignedto:a.assignedto},a.taskid).subscribe(c=>{})}recieveDelete(){this.fetchData()}newTask(){this.dialog.open(P,{width:"50%",data:{task:{}}}).afterClosed().subscribe(o=>{this.todo.push(o)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.uw),t.Y36(f.g),t.Y36(m.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-kanban"]],decls:24,vars:21,consts:[["pButton","","icon","pi pi-plus",1,"p-button-success",3,"click"],[1,"container-wrapper"],[1,"container"],["cdkDropList","","id","todo",1,"list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["todoList","cdkDropList"],["class","empty-label",4,"ngIf"],["cdkDrag","",3,"task","deleteEvent",4,"ngFor","ngForOf"],["cdkDropList","","id","inProgress",1,"list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["inProgressList","cdkDropList"],["cdkDropList","","id","done",1,"list",3,"cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["doneList","cdkDropList"],[1,"empty-label"],["cdkDrag","",3,"task","deleteEvent"]],template:function(e,o){if(1&e&&(t.TgZ(0,"mat-toolbar")(1,"button",0),t.NdJ("click",function(){return o.newTask()}),t.qZA()(),t.TgZ(2,"div",1)(3,"div",2)(4,"h2"),t._uU(5,"To Do"),t.qZA(),t.TgZ(6,"mat-card",3,4),t.NdJ("cdkDropListDropped",function(c){return o.drop(c)}),t.YNc(8,Y,2,0,"p",5),t.YNc(9,S,1,1,"app-task",6),t.qZA()(),t.TgZ(10,"div",2)(11,"h2"),t._uU(12,"In progress"),t.qZA(),t.TgZ(13,"mat-card",7,8),t.NdJ("cdkDropListDropped",function(c){return o.drop(c)}),t.YNc(15,F,2,0,"p",5),t.YNc(16,w,1,1,"app-task",6),t.qZA()(),t.TgZ(17,"div",2)(18,"h2"),t._uU(19,"Done"),t.qZA(),t.TgZ(20,"mat-card",9,10),t.NdJ("cdkDropListDropped",function(c){return o.drop(c)}),t.YNc(22,Q,2,0,"p",5),t.YNc(23,E,1,1,"app-task",6),t.qZA()()()),2&e){const a=t.MAs(7),c=t.MAs(14),g=t.MAs(21);t.xp6(6),t.Q6J("cdkDropListData",o.todo)("cdkDropListConnectedTo",t.WLB(12,v,g,c)),t.xp6(2),t.Q6J("ngIf",0===o.todo.length),t.xp6(1),t.Q6J("ngForOf",o.todo),t.xp6(4),t.Q6J("cdkDropListData",o.inProgress)("cdkDropListConnectedTo",t.WLB(15,v,a,g)),t.xp6(2),t.Q6J("ngIf",0===o.inProgress.length),t.xp6(1),t.Q6J("ngForOf",o.inProgress),t.xp6(4),t.Q6J("cdkDropListData",o.done)("cdkDropListConnectedTo",t.WLB(18,v,a,c)),t.xp6(2),t.Q6J("ngIf",0===o.done.length),t.xp6(1),t.Q6J("ngForOf",o.done)}},directives:[A.Ye,_.Hq,k.a8,d.Wj,p.O5,p.sg,O,d.Zt],styles:["h1[_ngcontent-%COMP%]{font:200% Helvetica,sans-serif;font-weight:700}.kanban-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr}.category[_ngcontent-%COMP%]{padding:1rem;margin:1rem;border-radius:1rem;border:solid lightslategrey .1rem}.container-wrapper[_ngcontent-%COMP%]{display:flex}.container[_ngcontent-%COMP%]{width:30%;margin:1rem}"]}),n})();var J=i(7376),q=i(4297),H=i(520);let $=(()=>{class n{constructor(e){this.http=e,this.baseUrl="http://34.130.167.193/projects/comments"}getComments(e){return this.http.get(this.baseUrl+"/"+e)}postComment(e){return this.http.post(this.baseUrl+"/"+e.project_id,e)}likeComment(e,o){return this.http.patch(this.baseUrl+`/${e}/${o}`,{like_value:1})}removeLike(e,o){return this.http.patch(this.baseUrl+`/${e}/${o}`,{like_value:-1})}deleteComment(e,o){return this.http.delete(this.baseUrl+`/${e}/${o}`)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(H.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var B=i(9891),z=i(3407),R=i(681);function W(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return a.onDelete(a.comment.comment_id)}),t.qZA()}}function X(n,s){if(1&n&&(t.TgZ(0,"div",1)(1,"div",2)(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span",3),t._uU(5),t.ALo(6,"timeSince"),t.qZA(),t.YNc(7,W,1,0,"button",4),t.ALo(8,"async"),t.ALo(9,"async"),t.ALo(10,"async"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.qZA(),t._UZ(13,"p-divider"),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.comment.name),t.xp6(2),t.hij("",t.lcZ(6,4,e.comment.posted_on)," ago"),t.xp6(2),t.Q6J("ngIf",t.lcZ(8,6,e.isAdmin$)||e.comment.author_uid==t.lcZ(9,8,e.uid)&&t.lcZ(10,10,e.isLoggedIn$)),t.xp6(5),t.Oqu(e.comment.content)}}let V=(()=>{class n{constructor(e){this.auth=e,this.deleteComment=new t.vpe,this.isAdmin$=this.auth.isAdmin$,this.uid=this.auth.userId$,this.isLoggedIn$=this.auth.isLoggedIn$}ngOnInit(){}onDelete(e){this.deleteComment.emit(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.e))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comment"]],inputs:{comment:"comment",likedComments:"likedComments"},outputs:{deleteComment:"deleteComment"},decls:1,vars:1,consts:[["class","wrapper",4,"ngIf"],[1,"wrapper"],[1,"header"],[2,"margin-left","1rem"],["icon","pi pi-trash","pButton","","class","p-button-outlined p-button-danger p-button-sm",3,"click",4,"ngIf"],["icon","pi pi-trash","pButton","",1,"p-button-outlined","p-button-danger","p-button-sm",3,"click"]],template:function(e,o){1&e&&t.YNc(0,X,14,12,"div",0),2&e&&t.Q6J("ngIf",o.comment)},directives:[p.O5,_.Hq,J.i],pipes:[R.A,p.Ov],styles:["p[_ngcontent-%COMP%]{margin-top:.2rem}button[_ngcontent-%COMP%]{border:none;background-color:#fff}button[_ngcontent-%COMP%]:hover{color:red}.header[_ngcontent-%COMP%]{color:gray}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:2rem}"]}),n})();function G(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-comment",9),t.NdJ("deleteComment",function(a){return t.CHM(e),t.oxw(2).onDelete(a)}),t.qZA()}2&n&&t.Q6J("comment",s.$implicit)}function tt(n,s){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,G,1,1,"app-comment",8),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.comments)}}let et=(()=>{class n{constructor(e,o,a,c){this.route=e,this.commentService=o,this.auth=a,this.toast=c}ngOnInit(){this.route.paramMap.pipe((0,h.w)(e=>this.commentService.getComments(parseInt(e.get("id"))))).subscribe(e=>this.comments=e)}onSubmit(){this.formContent&&this.route.paramMap.subscribe(e=>{const o={comment_id:0,project_id:parseInt(e.get("id")),author_uid:this.auth.uid,name:this.auth.name,posted_on:new Date,like_count:0,content:this.formContent};this.commentService.postComment(o).subscribe({next:a=>{this.toast.genericSuccess(),this.comments.push(o),console.log(a)},error:()=>this.toast.genericError("Comment Post Failed.")})})}onDelete(e){this.route.paramMap.subscribe(o=>{this.commentService.deleteComment(parseInt(o.get("id")),e).subscribe({next:()=>{this.toast.genericSuccess(),this.comments=this.comments.filter(a=>a.comment_id!=e)},error:()=>this.toast.genericError("Couldn't delete comment.")})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36($),t.Y36(u.e),t.Y36(B.k))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-comments"]],decls:10,vars:3,consts:[[2,"margin-bottom","3rem"],[2,"text-align","center"],[3,"ngSubmit"],[1,"p-float-label"],["pInputTextarea","","name","content","id","float-input","rows","2","cols","82",3,"ngModel","autoResize","ngModelChange"],["for","float-input"],["icon","pi pi-reply","pButton","",1,"p-button-outlined","p-button-sm"],[4,"ngIf"],[3,"comment","deleteComment",4,"ngFor","ngForOf"],[3,"comment","deleteComment"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h2",1),t._uU(2,"Comments"),t.qZA(),t.TgZ(3,"form",2),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(4,"span",3)(5,"textarea",4),t.NdJ("ngModelChange",function(c){return o.formContent=c}),t.qZA(),t.TgZ(6,"label",5),t._uU(7,"Add a comment..."),t.qZA()(),t._UZ(8,"button",6),t.qZA()(),t.YNc(9,tt,2,1,"div",7)),2&e&&(t.xp6(5),t.Q6J("ngModel",o.formContent)("autoResize",!0),t.xp6(4),t.Q6J("ngIf",o.comments))},directives:[r._Y,r.JL,r.F,r.Fj,z.g,r.JJ,r.On,_.Hq,p.O5,p.sg,V],styles:[""]}),n})();const nt=[{path:"",component:(()=>{class n{constructor(e,o){this.route=e,this.projectService=o}ngOnInit(){this.route.paramMap.pipe((0,h.w)(e=>this.projectService.getProject(parseInt(e.get("id"))))).subscribe(e=>{this.project=e})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(j.Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-project"]],decls:6,vars:1,consts:[[3,"project"],[1,"comments"]],template:function(e,o){1&e&&(t._UZ(0,"app-project-header",0)(1,"app-kanban")(2,"p-divider"),t.TgZ(3,"p-card")(4,"div",1),t._UZ(5,"app-comments"),t.qZA()()),2&e&&t.Q6J("project",o.project)},directives:[I,K,J.i,q.Z,et],styles:[".comments[_ngcontent-%COMP%]{max-width:50rem;margin-bottom:5rem;margin-left:auto;margin-right:auto}"]}),n})()}];let ot=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.Bz.forChild(nt)],m.Bz]}),n})();var st=i(894),at=i(8061),it=i(4534);let rt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.ez,ot,st.m,d._t,at.Q,it.V,k.QW,d._t,C.ot,l.Is,D.c,A.g0,r.u5,r.UX,M.kW]]}),n})()}}]);